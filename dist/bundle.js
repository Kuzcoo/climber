!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=8)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.canvas=document.getElementById("canvas"),a=(t.ctx=n.getContext("2d"),t.canvasWidth=304),s=t.canvasHeight=231,r=t.frameWidth=256,u=t.frameHeight=128;t.framePosX=a/2-r/2,t.framePosY=s/2-u/2},function(e,t,i){"use strict";function n(e){return o[e]}function a(e){return new Promise(function(t){s(e).then(function(e){e.forEach(function(e){var t=e.name,i=e.img;o[t]=i}),t(u)})})}function s(e){var t=e.map(function(e){return r(e.name,e.path)});return Promise.all(t)}function r(e,t){return new Promise(function(i){var n=document.createElement("img");n.onload=function(){return i({name:e,img:n})},n.src=t})}Object.defineProperty(t,"__esModule",{value:!0}),t.getImageByName=n,t.loadImages=a;var u="LOAD_SUCESS",o={}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GAME_LOAD="GAME_LOAD",t.GAME_PLAY="GAME_PLAY",t.GAME_OVER="GAME_OVER"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=null,a=null,s={},r=function(e,t){s[e]=t},u=function(e){n=e},o=function e(){d(),f(),a=requestAnimationFrame(e)},c=function(){s[n].load()},l=function(){s[n].handleInputs()},d=function(){s[n].update()},f=function(){s[n].draw()},h=function(){a&&cancelAnimationFrame(a),o()},m=function(){return{addState:r,setState:u,load:c,handleInputs:l,update:d,draw:f,start:h}}();t.default=m},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){d.default.addState(_.GAME_LOAD,{load:s})}function s(){(0,h.init)(),v.default.addEntity("climber",x),v.default.addEntity("goal",P),r().then(function(){return u(1)}).then(function(){return o()})}function r(){return(0,f.loadImages)([{name:"sprite",path:"../assets/sprite.png"},{name:"game_over",path:"../assets/game_over.png"}])}function u(e){return(0,f.loadImages)([{name:"level1",path:"../assets/level"+e+".png"}])}function o(){d.default.setState(_.GAME_PLAY),d.default.start()}Object.defineProperty(t,"__esModule",{value:!0}),t.goal=t.map=t.climber=void 0,t.setLoadState=a,t.loadLevel=u;var c=i(0),l=i(3),d=n(l),f=i(1),h=i(7),m=i(5),v=n(m),y=i(9),p=n(y),g=i(11),b=n(g),E=i(12),w=n(E),_=i(2),x=t.climber=new b.default(c.canvasWidth-18,c.canvasHeight-74),P=(t.map=new p.default(0,0,"level1"),t.goal=new w.default(32,25));a()},function(e,t,i){"use strict";function n(e,t){r[e]||(r[e]=[]),r[e].push(t)}function a(e){r[e]=null}function s(e,t){var i=r[e][0];return r[t].some(function(e){return e.x<i.x+i.width&&e.x+e.width>i.x&&e.y<i.y+i.height&&e.height+e.y>i.y})}Object.defineProperty(t,"__esModule",{value:!0});var r={};t.default={addEntity:n,removeEntity:a,isColliding:s}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=null,a=null,s=null,r=null;t.setCanvasSize=function(){n.width=s,n.height=r},t.background=function(e){a.fillStyle=e,a.fillRect(0,0,s,r)},t.clearScreen=function(){a.clearRect(0,0,s,r)},t.configure=function(e){var t=e.canvas,i=e.ctx,u=e.canvasWidth,o=e.canvasHeight;n=t,a=i,s=u,r=o}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={},a=t.KEY={LEFT:37,UP:38,RIGHT:39,DOWN:40};t.isPressed=function(e){return n[e]},t.isPressedAny=function(){return[].filter.call(Object.keys(n),function(e){return!0===n[e]}).length>0},t.setKey=function(e){e.prototype.setKey=function(e,t){switch(e){case"UP":this.keyUp=a[t];break;case"DOWN":this.keyDown=a[t]}}},t.init=function(){window.addEventListener("keydown",function(e){n[e.keyCode]=!0}),window.addEventListener("keyup",function(e){n[e.keyCode]=!1})}},function(e,t,i){"use strict";var n=i(6),a=i(0),s=i(2),r=i(3),u=function(e){return e&&e.__esModule?e:{default:e}}(r);i(4),i(13),(0,n.configure)({canvas:a.canvas,ctx:a.ctx,canvasWidth:a.canvasWidth,canvasHeight:a.canvasHeight}),(0,n.setCanvasSize)(),u.default.setState(s.GAME_LOAD),u.default.load()},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(0),r=i(1),u=i(10),o=function(){function e(t,i,a){n(this,e),this.x=t,this.y=i,this.level=a}return a(e,[{key:"hasLadder",value:function(e,t){return u.ladders.some(function(i){return e>i.x&&e<i.x+16&&t>i.y-28&&t<i.y})}},{key:"hasLadderBelow",value:function(e,t){return u.ladders.some(function(i){return e>i.x&&e<i.x+16&&t===i.y-24})}},{key:"draw",value:function(){s.ctx.drawImage((0,r.getImageByName)(this.level),0,0)}}]),e}();t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ladders=[{x:16,y:175},{x:96,y:175},{x:176,y:175},{x:256,y:175},{x:56,y:151},{x:136,y:151},{x:216,y:151},{x:296,y:151},{x:16,y:127},{x:96,y:127},{x:176,y:127},{x:256,y:127},{x:56,y:103},{x:136,y:103},{x:216,y:103},{x:296,y:103},{x:16,y:79},{x:96,y:79},{x:176,y:79},{x:256,y:79},{x:56,y:55},{x:136,y:55},{x:216,y:55},{x:296,y:55}]},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(0),r=i(1),u=i(7),o=i(4),c="STATE_STAND",l=0,d=function(){function e(t,i){n(this,e),this.width=16,this.height=18,this.velocity=1,this.imageNumber=0,this.state=c,this.framesByImage=8,this.framesElapsed=0,this.direction=l,this.x=t,this.y=i,this.initialPosX=t,this.initialPosY=i}return a(e,[{key:"reset",value:function(){this.x=this.initialPosX,this.y=this.initialPosY,this.direction=l,this.state=c,this.framesElapsed=0,this.imageNumber=0}},{key:"canClimb",value:function(){return o.map.hasLadder(this.x+this.width/2,this.y)}},{key:"canClimbDown",value:function(){return o.map.hasLadderBelow(this.x+this.width/2,this.y+this.height)}},{key:"hasEndedClimb",value:function(){return!o.map.hasLadder(this.x+this.width/2,this.y+14)}},{key:"hasEndedClimbDown",value:function(){return!o.map.hasLadder(this.x+this.width/2,this.y+18)}},{key:"updateClimbFrame",value:function(){++this.framesElapsed<this.framesByImage||(this.framesElapsed=0,this.imageNumber=2==++this.imageNumber?0:this.imageNumber)}},{key:"updateWalkFrame",value:function(){++this.framesElapsed<this.framesByImage||(this.framesElapsed=0,this.imageNumber=3==++this.imageNumber?0:this.imageNumber)}},{key:"handleClimb",value:function(){if((0,u.isPressed)(u.KEY.UP)){if(this.hasEndedClimb())return this.state=c;this.y-=this.velocity/2,this.updateClimbFrame()}if((0,u.isPressed)(u.KEY.DOWN)){if(this.hasEndedClimbDown())return this.state=c;this.y+=this.velocity/2,this.updateClimbFrame()}}},{key:"handleStand",value:function(){if((0,u.isPressed)(u.KEY.LEFT)&&(this.x-=this.velocity,this.direction=l,this.imageNumber=1,this.state="STATE_WALK"),(0,u.isPressed)(u.KEY.RIGHT)&&(this.x+=this.velocity,this.direction=1,this.imageNumber=1,this.state="STATE_WALK"),(0,u.isPressed)(u.KEY.UP)){if(!this.canClimb())return;this.y-=this.velocity,this.direction=2,this.imageNumber=0,this.state="STATE_CLIMB"}if((0,u.isPressed)(u.KEY.DOWN)){if(!this.canClimbDown())return;this.y+=this.velocity,this.direction=2,this.imageNumber=0,this.state="STATE_CLIMB"}}},{key:"handleWalk",value:function(){if(!(0,u.isPressed)(u.KEY.LEFT)&&!(0,u.isPressed)(u.KEY.RIGHT))return this.imageNumber=0,this.framesElapsed=0,this.state=c;(0,u.isPressed)(u.KEY.LEFT)&&(this.x-=this.velocity,this.updateWalkFrame()),(0,u.isPressed)(u.KEY.RIGHT)&&(this.x+=this.velocity,this.updateWalkFrame())}},{key:"setHurtState",value:function(){"STATE_HURT"!==this.state&&(this.state="STATE_HURT",this.setHurtGraphics())}},{key:"setHurtGraphics",value:function(){this.framesElapsed=0,this.imageNumber=0,this.direction=3}},{key:"updateHurtFrame",value:function(){++this.framesElapsed<this.framesByImage||(this.framesElapsed=0,this.imageNumber=2==++this.imageNumber?0:this.imageNumber)}},{key:"handleHurt",value:function(){this.updateHurtFrame()}},{key:"handleInputs",value:function(){switch(this.state){case c:this.handleStand();break;case"STATE_WALK":this.handleWalk();break;case"STATE_CLIMB":this.handleClimb();break;case"STATE_HURT":this.handleHurt()}}},{key:"update",value:function(){this.handleInputs()}},{key:"draw",value:function(){s.ctx.imageSmoothingEnabled=!1,s.ctx.drawImage((0,r.getImageByName)("sprite"),this.imageNumber*this.width,this.direction*this.height+this.direction,this.width,this.height,this.x,this.y,this.width,this.height)}}]),e}();t.default=d},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(0),r=function(){function e(t,i){n(this,e),this.width=6,this.height=6,this.color="white",this.x=t,this.y=i}return a(e,[{key:"draw",value:function(){s.ctx.fillStyle=this.color,s.ctx.fillRect(this.x,this.y,this.width,this.height)}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){return u.default["level"+b].laserVelocity}var s=i(6),r=i(14),u=n(r),o=i(3),c=n(o),l=i(5),d=n(l),f=i(2),h=i(4),m=i(15),v=i(16),y=i(17),p=0,g=!1,b=1;(0,y.initialize)(7,a()),c.default.addState(f.GAME_OVER,{handleInputs:function(){},update:function(){},draw:function(){(0,m.draw)()}}),c.default.addState(f.GAME_PLAY,{handleInputs:function(){},update:function(){g||(d.default.isColliding("climber","laser")&&(h.climber.setHurtState(),(0,v.decrement)(),c.default.setState(f.GAME_HIT)),d.default.isColliding("climber","goal")&&(g=!0,(0,h.loadLevel)(++b).then(function(){(0,y.reset)(7,a()),h.climber.reset(),g=!1})),(0,y.update)(),h.climber.update())},draw:function(){(0,s.clearScreen)(),(0,s.background)("black"),h.map.draw(),(0,y.draw)(),h.climber.draw(),h.goal.draw(),(0,v.draw)()}}),c.default.addState(f.GAME_HIT,{handleInputs:function(){},update:function(){p++,120===p&&(p=0,0!==(0,v.getLife)()?(h.climber.reset(),(0,y.reset)(7,a()),c.default.setState(f.GAME_PLAY)):c.default.setState(f.GAME_OVER)),(0,y.update)(),h.climber.update()},draw:function(){(0,s.clearScreen)(),(0,s.background)("black"),h.map.draw(),(0,y.draw)(),h.climber.draw(),(0,v.draw)()}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={laserVelocity:.5},a={laserVelocity:.6},s={laserVelocity:.7},r={laserVelocity:.8},u={laserVelocity:.9},o={laserVelocity:.8},c={level1:n,level2:a,level3:s,level4:r,level5:u,level6:o};t.default=c},function(e,t,i){"use strict";function n(){a.ctx.drawImage((0,s.getImageByName)("game_over"),98,191)}Object.defineProperty(t,"__esModule",{value:!0}),t.draw=n;var a=i(0),s=i(1)},function(e,t,i){"use strict";function n(){return 0===(u-=1)}function a(){for(var e=0;e<u;e++)s.ctx.drawImage((0,r.getImageByName)("sprite"),32,57,16,17,32*e+8,191,16,17)}Object.defineProperty(t,"__esModule",{value:!0}),t.getLife=void 0,t.decrement=n,t.draw=a;var s=i(0),r=i(1),u=2;t.getLife=function(){return u}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){l(e,t),c()}function s(){var e=y.filter(function(e,t){return!y[t].instance.isActive});c(),e.forEach(function(e,t){e.alive=!0,e.instance.reset(),e.instance.activate(Math.max(160,300*Math.random()))})}function r(e,t){y=[],v.default.removeEntity("laser"),a(e,t)}function u(){s(),y.filter(function(e){return e.alive}).forEach(function(e){d(e)?(e.instance.desactivate(),e.alive=!1):e.instance.update()})}function o(){y.filter(function(e){return e.alive}).forEach(function(e){e.instance.draw()})}function c(){for(var e=0;e<3;e++)y[e].instance.activate(60)}function l(e,t){for(var i=0;i<e;i++)y.push({alive:!0,instance:new h.default(0,p[i],t)}),v.default.addEntity("laser",y[i].instance)}function d(e){return e.instance.x>304}Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=a,t.launchLasers=s,t.reset=r,t.update=u,t.draw=o;var f=i(18),h=n(f),m=i(5),v=n(m),y=[],p=[131,83,35,155,107,59,11]},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(0),r=i(1),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;n(this,e),this.width=4,this.height=20,this.isActive=!1,this.spritePos=48,this.framesElapsed=0,this.startAfterFrames=0,this.savedPos=0,this.x=t,this.y=i,this.velocity=a,this.savedPos=i}return a(e,[{key:"activate",value:function(e){this.isActive=!0,this.startAfterFrames=e}},{key:"desactivate",value:function(){this.isActive=!1,this.framesElapsed=0}},{key:"setVelocity",value:function(e){this.velocity=e}},{key:"reset",value:function(){this.x=0,this.y=this.savedPos}},{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"update",value:function(){this.isActive&&this.framesElapsed>=this.startAfterFrames&&(this.x+=this.velocity),this.framesElapsed++}},{key:"draw",value:function(){s.ctx.drawImage((0,r.getImageByName)("sprite"),this.spritePos,37,this.width,this.height,this.x,this.y,this.width,this.height)}}]),e}();t.default=u}]);